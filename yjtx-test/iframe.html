<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>摩尔战记</title>
    <meta name="viewport"
          content="width=device-width,initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="full-screen" content="true">
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-fullscreen" content="true">
    <meta name="360-fullscreen" content="true">

    <script src="css/jquery-1.10.2.min.js" type="text/javascript"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            border: 0;
            outline: 0;
            font-size: 110%;
            vertical-align: middle
        }

        html, body {
            background: #ffffff
        }
    </style>
</head>
<body style="height:100%">

<div id="iframeDiv">

    <iframe id="iframe" name="iframe" frameborder="0" border="none" padding="0px" marginwidth="0" marginheight="0" scrolling="no" height="800" width="100%"
            style="height: 627px;display:none"></iframe>

</div>

<script type="text/javascript">
    var url = getOption("url");
    var iframe = document.getElementById("iframe");

    setTimeout(function () {
        iframe.style.display = "block";
    }, 20000);

    iframe.src = url;
    iframe.contentWindow.addEventListener("resize", function() {
        console.log("sdfsfsdf")
    });

    console.log(iframe.contentWindow.name);

    function setHeight() {
        var height = getHeight();

        $("#iframe").height(height);
    }

    function getHeight() {
        var winHeight = 0;
        //获取窗口高度
        if (window.innerHeight) {
            winHeight = window.innerHeight;
        } else if ((document.body) && (document.body.clientHeight)) {
            winHeight = document.body.clientHeight;
        }
        //通过深入Document内部对body进行检测，获取窗口大小
        if (document.documentElement && document.documentElement.clientHeight) {
            winHeight = document.documentElement.clientHeight;
        }
        return winHeight;
    }

    $(document).ready(function () {
        setHeight();
    });


    function getOption(key) {
        var search = location.search;
        if (search == "") {
            return "";
        }
        search = search.slice(1);
        var searchArr = search.split("&");

        var length = searchArr.length;
        for (var i = 0; i < length; i++) {
            var str = searchArr[i];
            var reg = new RegExp("^" + key + "=");
            str = str.replace(reg, "");
            str = str.replace(/%26/g, "&");
            return str;
        }
        return "";
    }
</script>

</body>
</html>
