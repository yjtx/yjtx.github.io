---
author: yjtx
date: 2016-03-08 11:07:39+00:00
layout: post
title: 最佳实践
pid: 15
tags:
- 博客
- 最佳实践
---


### 声音

1、刚开始只加载入口的背景音乐文件。

2、点击 stage 后触发声音播放。

3、点击登录等按钮后，去加载后面需要的音乐文件。

同一个文件a 尽量在同一时间段只播放一个，不然第二个播放的声音在第一次同时播放时可能会有延迟（这个需要看各个手机浏览器的实现）。

4、文件使用格式工厂转成 44100Hz、96kbps

### 图片

1、单张图不要超过 1024 * 1024。

2、将碎图合成一张大图。

3、9宫图使用时，不要使用非整数的宽高，图片 localToGlobal 后的坐标不要有小数（部分浏览器解析会导致缝隙）。

### 遮罩

1、遮罩如果是 DisplayObject，请修改遮罩数据后，重新将遮罩赋值给对象。

2、遮罩如果是 DisplayObject，必须加入到显示列表后，方能正常使用。

3、遮罩如果是 Rectangle，没有上面限制。

### 布局
1、建议设计分辨率  640 * 960。适配模式建议 fixedWidth、fixedHeight。

1、尽量将静态图或者文字放到一个容器中，并对容器缓存（cacheAsBitmap）。

2、由于在 native 下会有图片的批处理，即同一张图集的图在连续绘制时速度会比一个间隔一个快很多。因此请尽量将同一张图集的素材连续布局，中间不要插入其他的图片或者文字。

### 加载

1、不要一次性下载太多的素材，尽量分布在使用前加载。

2、请加入静默加载，比如在登录页面操作时下载主页面相关素材。

3、登录+主页面的素材不要超过2m（如果一个手机下载速度100k，则需要20s），其他不是特别重要的素材可在主页面显示后再下载。

4、尽量将配置文件合并到一个大文件里，减少下载数量。

5、将碎图合成一张大图，减少下载数量。

6、图片如果加载是跨域图片，加载前需要设置 egret.ImageLoader.crossOrigin = "anonymous"。

7、尽量不要加载跨域图片、配置等。

### 文字

1、尽可能使用默认字体，如果修改其他的字体，可能会由于浏览器不兼容而显示不同。

2、尽量不要使用描边。

### 帧频

1、请使用 60 的约数作为帧频数。

2、位移计算请不要通过帧数来计算，而是根据实际的帧时间间隔来计算（可避免显示的抖动）。

3、使用 startTicker、 stopTicker。


### 动画

1、对于简单的动画，序列帧或者db的急速模式更加。

2、复杂一些的动画，使用 db。

### 适配
1、横竖屏适配

2、不同手机分辨率对应不同尺寸图形的适配。



### 其他

1、请尽量不要使用方法内创建函数，如果使用，请将函数声明放在方法的最开始处。

2、ts 中没有属性的 super 调用，请使用 egret.getter 和 egret.setter 代替。



### List
1.属性要有默认值，用于类型判断。
2.自定义组件构造函数参数必须为空。
3.组件要能单独实例化后读取属性值，因此getter方法里不能存在报错，要注意对null值访问时的判断。